<!--
  è§†é¢‘ç”»å»Šé¡µé¢ - LittleFencer å°ç¨‹åº
-->
<view class="container">
  <!-- ç­›é€‰æ  -->
  <view class="filter-bar">
    <view 
      class="filter-item {{currentFilter === 'all' ? 'active' : ''}}"
      data-filter="all"
      bindtap="onFilterChange"
    >ğŸ“¹ å…¨éƒ¨</view>
    <view 
      class="filter-item {{currentFilter === 'starred' ? 'active' : ''}}"
      data-filter="starred"
      bindtap="onFilterChange"
    >â­ ç²¾å½©</view>
    <view 
      class="filter-item {{currentFilter === 'recent' ? 'active' : ''}}"
      data-filter="recent"
      bindtap="onFilterChange"
    >ğŸ• æœ€è¿‘</view>
  </view>

  <!-- åŠ è½½ä¸­ -->
  <view class="loading" wx:if="{{loading}}">
    <view class="loading-spinner"></view>
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- è§†é¢‘åˆ—è¡¨ -->
  <view class="video-grid" wx:elif="{{videos.length > 0}}">
    <view 
      class="video-item"
      wx:for="{{videos}}"
      wx:key="_id"
      data-video="{{item}}"
      bindtap="onPlayVideo"
    >
      <!-- è§†é¢‘å°é¢ -->
      <view class="video-cover">
        <image 
          class="cover-image" 
          src="{{item.coverUrl || '/assets/images/video_placeholder.png'}}"
          mode="aspectFill"
        ></image>
        <view class="play-icon">â–¶ï¸</view>
        <view class="duration-badge">{{item.duration}}s</view>
      </view>
      
      <!-- è§†é¢‘ä¿¡æ¯ -->
      <view class="video-info">
        <view class="video-stats">
          <text>ğŸ¯ {{item.actionCount || 0}}</text>
          <text>â­ {{item.perfectCount || 0}}</text>
          <text>ğŸ”¥ {{item.maxCombo || 0}}</text>
        </view>
        <view class="video-date">{{item.createTime}}</view>
      </view>
      
      <!-- æ“ä½œæŒ‰é’® -->
      <view class="video-actions" catchtap="stopPropagation">
        <button class="action-btn" data-video="{{item}}" catchtap="onShareVideo">ğŸ“¤</button>
        <button class="action-btn" data-video="{{item}}" catchtap="onSaveToAlbum">ğŸ’¾</button>
        <button class="action-btn danger" data-video="{{item}}" catchtap="onDeleteVideo">ğŸ—‘ï¸</button>
      </view>
    </view>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty-state" wx:else>
    <text class="empty-icon">ğŸ“¹</text>
    <text class="empty-text">è¿˜æ²¡æœ‰è®­ç»ƒè§†é¢‘</text>
    <text class="empty-hint">å»è®­ç»ƒé¡µé¢å½•åˆ¶ä½ çš„ç¬¬ä¸€ä¸ªè§†é¢‘å§ï¼</text>
    <navigator class="btn btn-primary mt-md" url="/pages/training/training" open-type="switchTab">
      å¼€å§‹è®­ç»ƒ
    </navigator>
  </view>

  <!-- è§†é¢‘æ’­æ”¾å™¨å¼¹çª— -->
  <view class="player-modal" wx:if="{{showPlayer}}" bindtap="onClosePlayer">
    <view class="player-content" catchtap="stopPropagation">
      <video 
        class="player-video"
        src="{{currentVideo.fileID}}"
        controls
        autoplay
        show-fullscreen-btn
        show-play-btn
        enable-progress-gesture
      ></video>
      <view class="player-info">
        <view class="player-stats">
          <text>åŠ¨ä½œ: {{currentVideo.actionCount || 0}}</text>
          <text>å®Œç¾: {{currentVideo.perfectCount || 0}}</text>
          <text>è¿å‡»: {{currentVideo.maxCombo || 0}}</text>
        </view>
      </view>
      <button class="close-btn" bindtap="onClosePlayer">âœ•</button>
    </view>
  </view>
</view>
