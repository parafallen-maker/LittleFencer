# Product Requirements Document: LittleFencer 微信小程序版

> **Version:** 1.0  
> **Status:** Draft  
> **Last Updated:** 2026-02-01  
> **Platform:** 微信小程序 (WeChat Mini Program)  
> **Scope:** 社交裂变 + 轻量训练入口

---

## 1. 产品定位

### 1.1 战略目标
微信小程序版 **不是** 主训练平台的替代品，而是 **社交裂变引擎** 和 **流量入口**：

| 平台 | 核心定位 | 用户场景 |
|------|---------|---------|
| Android/iOS/Web PWA | 主力训练平台 | 每日独立训练 |
| **微信小程序** | 社交裂变 + 轻量体验 | 朋友圈分享、好友对战、拉新 |

### 1.2 核心价值主张
- 🔗 **即点即用**：无需下载，微信内直接体验
- 📤 **一键分享**：训练成就自动生成精美卡片
- 🎮 **好友挑战**：PK 模式驱动社交传播
- 🚀 **引流转化**：体验后引导下载完整版 App

---

## 2. 技术能力分析

### 2.1 微信小程序能力边界

| 能力 | 支持程度 | 限制说明 |
|------|---------|---------|
| **摄像头访问** | ✅ 支持 | `wx.createCameraContext()` |
| **实时视频流** | ✅ 支持 | `<camera>` 组件 |
| **AI 推理** | ⚠️ 有限 | 仅支持 Vision Kit 预置模型 |
| **自定义 AI 模型** | ❌ 不支持 | 无法加载 MediaPipe/TFLite |
| **视频录制** | ✅ 支持 | `CameraContext.startRecord()` |
| **本地存储** | ⚠️ 有限 | 最大 200MB，视频需转存 |
| **分享能力** | ✅ 强大 | 原生支持朋友圈、好友分享 |
| **实时通信** | ✅ 支持 | WebSocket 实时对战 |

### 2.2 关键技术方案

#### 姿态检测方案
```
方案一：Vision Kit 人体检测（推荐 MVP）
├── 优点：原生支持，无需服务器
├── 缺点：仅 17 个关键点，精度有限
└── 适用：基础动作评估

方案二：云端推理
├── 流程：上传帧 → 云端 MediaPipe → 返回结果
├── 优点：精度高，与 App 一致
├── 缺点：延迟高（200-500ms），需要服务器
└── 适用：回放分析、精准评分
```

#### 推荐 MVP 方案
- **实时训练**：Vision Kit 本地推理（降级体验）
- **精准分析**：录制视频 → 云端分析 → 生成报告

---

## 3. 功能规划

### 3.1 P0 核心功能（MVP）

#### 3.1.1 轻量训练体验
- **简化版训练模式**
  - Vision Kit 检测基础姿态
  - 实时反馈：正确/错误（无详细纠正）
  - 动作计数 + Combo 累计
  - 录制精彩瞬间（手动触发）

#### 3.1.2 成就卡片生成
- **训练完成后生成分享卡片**
  ```
  ┌─────────────────────────┐
  │  ⚔️ LittleFencer      │
  │  ─────────────────      │
  │  [动态精彩帧/GIF]       │
  │                         │
  │  今日训练成果           │
  │  🎯 动作数: 42          │
  │  ⭐ 完美率: 78%         │
  │  🔥 最高连击: 12        │
  │                         │
  │  [小程序码]             │
  │  长按识别，一起练剑     │
  └─────────────────────────┘
  ```

#### 3.1.3 好友挑战系统
- **异步 PK 模式**
  - 发起挑战 → 生成挑战链接
  - 好友点击 → 完成同一套动作
  - 比较成绩 → 生成 PK 结果卡片

#### 3.1.4 排行榜
- **周榜/月榜**
  - 好友排行（基于微信关系链）
  - 全局排行（激励竞争）

### 3.2 P1 增强功能

#### 3.2.1 云端精准分析
- 上传训练视频 → 云端 MediaPipe 分析
- 生成详细报告：
  - 动作轨迹图
  - 关键帧标注
  - 改进建议

#### 3.2.2 教练互动
- 教练可查看学员训练数据
- 远程点评 + 语音反馈

#### 3.2.3 课程打卡
- 每日训练任务
- 打卡日历
- 连续打卡奖励

### 3.3 功能排除（不做）
- ❌ 完整的实时姿态纠正（受限于 Vision Kit 精度）
- ❌ 自动录制精彩片段（性能限制）
- ❌ 离线训练模式（需要网络支持排行榜）

---

## 4. 用户旅程

### 4.1 新用户获客流程
```
朋友圈看到训练卡片
    ↓
长按识别小程序码
    ↓
进入小程序「快速体验」
    ↓
完成 3 个动作 Demo
    ↓
展示成绩 + 引导分享
    ↓
提示下载完整版获得更多功能
```

### 4.2 挑战传播流程
```
用户 A 完成训练
    ↓
生成「挑战好友」卡片
    ↓
分享到微信群/好友
    ↓
用户 B 点击接受挑战
    ↓
用户 B 完成训练
    ↓
生成 PK 结果卡片
    ↓
双方分享到朋友圈
```

---

## 5. 技术架构

### 5.1 系统架构
```
┌─────────────────────────────────────────────┐
│              微信小程序客户端                 │
├─────────────────────────────────────────────┤
│  ┌─────────┐ ┌─────────┐ ┌─────────────┐   │
│  │ Camera  │ │ Vision  │ │   Canvas    │   │
│  │ 组件    │ │ Kit     │ │   渲染层    │   │
│  └─────────┘ └─────────┘ └─────────────┘   │
├─────────────────────────────────────────────┤
│  ┌─────────────────────────────────────┐    │
│  │         业务逻辑层                   │    │
│  │  训练管理 | 成绩计算 | 卡片生成     │    │
│  └─────────────────────────────────────┘    │
└─────────────────────────────────────────────┘
                    ↓ HTTPS
┌─────────────────────────────────────────────┐
│                 云服务后端                   │
├─────────────────────────────────────────────┤
│  ┌──────────┐ ┌──────────┐ ┌──────────┐    │
│  │ 用户服务  │ │ 排行榜   │ │ 视频分析 │    │
│  │          │ │ 服务     │ │ 服务     │    │
│  └──────────┘ └──────────┘ └──────────┘    │
├─────────────────────────────────────────────┤
│  ┌──────────────────────────────────────┐   │
│  │           云数据库 + 对象存储          │   │
│  └──────────────────────────────────────┘   │
└─────────────────────────────────────────────┘
```

### 5.2 技术栈
- **前端框架**：微信原生 / Taro / uni-app
- **后端服务**：微信云开发 / 自建服务器
- **数据库**：云数据库 (MongoDB)
- **存储**：云存储 (COS)
- **AI 分析**：云函数 + MediaPipe Python

---

## 6. 数据指标

### 6.1 北极星指标
- **周活跃分享用户数 (WAU Share)**
- **K Factor（病毒系数）**= 邀请转化数 / 活跃用户数

### 6.2 核心指标
| 指标 | 定义 | 目标 |
|------|------|------|
| 日活 (DAU) | 每日打开小程序用户数 | 1000+ |
| 分享率 | 完成训练后分享的用户比例 | > 30% |
| 挑战接受率 | 收到挑战后完成的比例 | > 50% |
| App 转化率 | 从小程序引导下载 App | > 5% |

---

## 7. 开发里程碑

### Phase 1: MVP (2周)
- [ ] 小程序项目初始化
- [ ] Camera 组件 + Vision Kit 集成
- [ ] 基础训练流程
- [ ] 成绩卡片生成
- [ ] 微信分享功能

### Phase 2: 社交功能 (2周)
- [ ] 用户系统（微信登录）
- [ ] 好友挑战系统
- [ ] 排行榜功能
- [ ] 挑战结果卡片

### Phase 3: 云端增强 (2周)
- [ ] 云端视频分析服务
- [ ] 训练报告生成
- [ ] 数据统计面板

---

## 8. 风险与缓解

| 风险 | 影响 | 缓解措施 |
|------|------|---------|
| Vision Kit 精度不足 | 训练体验差 | 降低预期，定位为「体验版」 |
| 云端分析成本高 | 服务器费用 | 限制免费分析次数 |
| 用户留存低 | 无法形成习惯 | 强化社交属性，弱化训练深度 |
| 审核风险 | 上线延迟 | 提前准备资质材料 |

---

## 9. 附录：与 App 版本的功能对比

| 功能 | App (Android/iOS/PWA) | 小程序 |
|------|----------------------|--------|
| 实时姿态检测 | ✅ 33点 MediaPipe | ⚠️ 17点 Vision Kit |
| 实时语音纠正 | ✅ | ❌ |
| 自动录制 | ✅ | ❌ 手动 |
| 精准评分 | ✅ | ⚠️ 云端延迟 |
| 离线训练 | ✅ | ❌ |
| 社交分享 | ⚠️ 需跳转 | ✅ 原生 |
| 好友挑战 | ❌ | ✅ |
| 排行榜 | ❌ | ✅ |

---

*文档结束*
